/*
 *             Copyright (c) 2016 - 2021, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x993e32}from'ckeditor5/src/core';import{getStyles as _0x58ad43}from'./utils';export default class o extends _0x993e32{constructor(_0x14f7c1){super(_0x14f7c1),this['set']('isBusy',!0x1),this['listenTo'](_0x14f7c1,'change:isReadOnly',(_0x3dcc34,_0x245aef,_0x281467)=>{_0x281467&&this['clearForceDisabled']('readOnlyMode');});}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x35beee={}){const _0x35cdd9=this['editor'],t=_0x35cdd9['t'],_0x495072=_0x35beee['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x1302a0=_0x35beee['dataCallback']||(_0x35d8b3=>_0x35d8b3['getData']()),_0xab3bf=_0x35cdd9['plugins']['get']('ExportPdf'),_0x509c74=_0x35beee['token']||_0xab3bf['_token'];return this['isBusy']=!0x0,this['refresh'](),_0x58ad43(_0x35beee['stylesheets']||['EDITOR_STYLES'])['then'](_0x181f26=>{const _0x2e22c3={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x35cdd9['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+_0x1302a0(_0x35cdd9)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x181f26,'options':_0x35beee['converterOptions']},_0x2e0ee3={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x509c74?{'Authorization':_0x509c74['value']}:null,'x-cs-app-id':_0x35beee['appID']||'cke5'},'body':JSON['stringify'](_0x2e22c3)};return window['fetch'](_0x495072,_0x2e0ee3)['then'](_0x4c3196=>{if(0xc8!==_0x4c3196['status'])throw _0x4c3196;return _0x4c3196['blob']();})['then'](_0x27b40f=>{this['o'](_0x27b40f,_0x35beee['fileName']||'document.pdf');});})['catch'](_0x1d9de4=>{throw _0x35cdd9['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x1d9de4;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x2fa408,_0x1e97d8){const _0xaeb600=document['createElement']('a');_0xaeb600['href']=window['URL']['createObjectURL'](_0x2fa408),_0xaeb600['download']=_0x1e97d8,_0xaeb600['click'](),_0xaeb600['remove']();}}